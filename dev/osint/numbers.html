<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>?? UK Number Prefix Lookup</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
  <style>
    html, body {
      height: 100%;
      margin: 0;
      background-color: #000;
      color: #f8f9fa;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen,
        Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif;
      display: flex;
      align-items: center;
      justify-content: center;
      text-align: center;
      padding: 1rem;
    }
    body {
      flex-direction: column;
      min-height: 100vh;
    }
    .app-container {
      max-width: 480px;
      width: 100%;
      display: flex;
      flex-direction: column;
      gap: 1.5rem;
    }
    h1 {
      font-weight: 700;
      margin-bottom: 0.25rem;
    }
    p.lead {
      font-weight: 300;
      margin-bottom: 1.5rem;
      color: #bbb;
    }

    /* From Uiverse.io by Li-Deheng */
    .search {
      --input-line: #cccccc;
      --input-text-color: #808080;
      --input-text-hover-color: transparent;
      --input-border-color: #808080;
      --input-border-hover-color: #999999;
      --input-bg-color: #333333;
      --search-max-width: 100%;
      --search-min-width: 100%;
      --border-radius: 5px;
      --transition-cubic-bezier: 150ms cubic-bezier(0.4,0,0.2,1);
      margin: 0 auto;
      position: relative;
      z-index: 2;
    }

    .search-box {
      height: 35px;
      border: 1px solid var(--input-border-color);
      border-radius: var(--border-radius);
      padding: 5px 15px;
      background: var(--input-bg-color);
      box-shadow: 0 0 20px rgba(0, 0, 0, 0.5);
      transition: var(--transition-cubic-bezier);
      position: relative;
      width: 100%;
    }

    .search-box:hover {
      border-color: var(--input-border-hover-color);
    }

    .search-field {
      position: relative;
      width: 100%;
      height: 100%;
      left: -5px;
      border: 0;
    }

    .input {
      width: calc(100% - 29px);
      height: 100%;
      border: 0;
      font-size: 1rem;
      padding-right: 0px;
      color: var(--input-line);
      background: var(--input-bg-color);
      border-right: 2px solid var(--input-border-color);
      outline: none;
    }

    .input::placeholder {
      color: var(--input-text-color);
    }

    .input:focus::placeholder {
      color: var(--input-text-hover-color);
    }

    .search-box-icon {
      width: 52px;
      height: 35px;
      position: absolute;
      top: -6px;
      right: -21px;
      background: transparent;
      border-bottom-right-radius: var(--border-radius);
      border-top-right-radius: var(--border-radius);
      transition: var(--transition-cubic-bezier);
    }

    .search-box-icon:hover {
      background: var(--input-border-color);
    }

    .btn-icon-content {
      width: 52px;
      height: 35px;
      background: transparent;
      border: none;
      cursor: pointer;
      border-bottom-right-radius: var(--border-radius);
      border-top-right-radius: var(--border-radius);
      transition: var(--transition-cubic-bezier);
      opacity: 0.4;
    }

    .btn-icon-content:hover {
      opacity: 0.8;
    }

    .search-icon {
      width: 21px;
      height: 21px;
      position: absolute;
      top: 7px;
      right: 15px;
    }

    .autocomplete-suggestions {
      list-style: none;
      padding: 0;
      margin: 0;
      border: 1px solid #444;
      border-top: none;
      max-height: 250px;
      overflow-y: auto;
      background: #1a1a1a;
      position: absolute;
      width: 100%;
      z-index: 3;
      text-align: left;
      border-radius: 0 0 5px 5px;
    }

    .autocomplete-suggestions li {
      padding: 12px;
      cursor: pointer;
      color: #f8f9fa;
      user-select: none;
    }

    .autocomplete-suggestions li:hover {
      background-color: #333;
    }

    .alert {
      background-color: #1a1a1a;
      border-color: #444;
      color: #f8f9fa;
      border-radius: 5px;
      padding: 1rem 1.25rem;
      font-size: 1rem;
      margin-top: 1rem;
      opacity: 1;
    }

    /* Fade-in animation */
    @keyframes fadeIn {
      from {
        opacity: 0;
        transform: translateY(10px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .fade-in {
      animation: fadeIn 0.4s ease forwards;
    }

    footer {
      font-size: 0.85rem;
      color: #666;
      margin-top: 3rem;
    }

    @media (max-width: 500px) {
      .app-container {
        max-width: 100%;
      }
      .search-box-icon {
        right: -15px;
      }
    }
  </style>
</head>
<body>

  <div class="app-container">
    <h1>?? UK Number Prefix Lookup</h1>
    <p class="lead">Search a UK number prefix to see its assigned provider</p>

    <div class="search">
      <div class="search-box">
        <div class="search-field">
          <input
            placeholder="Search…"
            class="input"
            id="search-input"
            type="text"
            autocomplete="off"
            spellcheck="false"
          />
          <div class="search-box-icon">
            <button class="btn-icon-content" aria-label="Search button">
              <i class="search-icon">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M416 208c0 45.9-14.9 88.3-40 122.7L502.6 457.4c12.5 12.5 12.5 32.8 0 45.3s-32.8 12.5-45.3 0L330.7 376c-34.4 25.2-76.8 40-122.7 40C93.1 416 0 322.9 0 208S93.1 0 208 0S416 93.1 416 208zM208 352a144 144 0 1 0 0-288 144 144 0 1 0 0 288z" fill="#fff"/></svg>
              </i>
            </button>
          </div>
        </div>
      </div>
      <ul id="suggestions" class="autocomplete-suggestions"></ul>
    </div>

    <div id="result" class="alert d-none" role="alert" aria-live="polite"></div>

    <footer>
      &copy; 2025 BlitzdUK
    </footer>
  </div>

<script>
const csvUrl = 'https://raw.githubusercontent.com/BlitzdUK/blitzduk.github.io/refs/heads/master/dev/osint/uknumbersSanitised.csv';
let data = [];

document.addEventListener('DOMContentLoaded', () => {
  const input = document.getElementById('search-input');
  const suggestions = document.getElementById('suggestions');
  const result = document.getElementById('result');

  fetch(csvUrl)
    .then(response => response.text())
    .then(text => {
      data = text.trim().split(/\r?\n/).map(line => line.split(','));
    });

  input.addEventListener('input', () => {
    const query = input.value.toLowerCase();
    suggestions.innerHTML = '';
    result.classList.add('d-none');

    if (query.length === 0) return;

    const matches = data.filter(row => row[0].toLowerCase().includes(query));

    if (matches.length === 0) {
      const li = document.createElement('li');
      li.textContent = 'No matches found';
      li.classList.add('text-muted', 'px-3', 'py-2');
      suggestions.appendChild(li);
      return;
    }

    matches.slice(0, 10).forEach(row => {
      const li = document.createElement('li');
      li.textContent = row[0];
      li.addEventListener('click', () => {
        input.value = row[0];
        suggestions.innerHTML = '';
        result.textContent = `Provider: ${row[1] || 'No details available'}`;
        result.classList.remove('d-none');

        // Animate alert box fade-in
        result.classList.remove('fade-in');
        void result.offsetWidth; // Trigger reflow
        result.classList.add('fade-in');
      });
      suggestions.appendChild(li);
    });
  });

  document.addEventListener('click', (e) => {
    if (e.target !== input) {
      suggestions.innerHTML = '';
    }
  });
});
</script>
</body>
</html>
